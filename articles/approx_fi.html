<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Approximate fit indices • blavaan</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Approximate fit indices">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">blavaan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5-5.1296</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-basics" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Basics</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-basics">
<li><a class="dropdown-item" href="../articles/start.html">Getting Started</a></li>
    <li><a class="dropdown-item" href="../articles/prior.html">Prior Specification</a></li>
    <li><a class="dropdown-item" href="../articles/estimate.html">Estimation</a></li>
    <li><a class="dropdown-item" href="../articles/convergence_efficiency.html">Convergence and Efficiency Evaluation</a></li>
    <li><a class="dropdown-item" href="../articles/summaries.html">Model Summaries</a></li>
    <li><a class="dropdown-item" href="../articles/plotting.html">Plots</a></li>
  </ul>
</li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-examples-details" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Examples/Details</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-examples-details">
<li><a class="dropdown-item" href="../articles/ordinal.html">Estimation with Ordinal Data</a></li>
    <li><a class="dropdown-item" href="../articles/multilevel.html">Two-level Estimation</a></li>
    <li><a class="dropdown-item" href="../articles/invariance.html">Measurement Invariance</a></li>
    <li><a class="dropdown-item" href="../articles/approx_fi.html">Approximate Fit Indices</a></li>
    <li><a class="dropdown-item" href="../articles/model_comparison.html">Model Comparison</a></li>
    <li><a class="dropdown-item" href="../articles/cross_loadings_strong_priors.html">Cross-loadings with Strong Priors</a></li>
    <li><a class="dropdown-item" href="../articles/mod_indices.html">Modification Indices</a></li>
    <li><a class="dropdown-item" href="../articles/prior_pred_checks.html">Prior Predictive Checks</a></li>
    <li><a class="dropdown-item" href="../articles/convergence_loop.html">Convergence Loop</a></li>
    <li><a class="dropdown-item" href="../articles/probability_direction.html">Probability of Direction</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/resources.html">Resources</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ecmerkle/blavaan"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://groups.google.com/d/forum/blavaan"><span class="fa fa-users"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Approximate fit indices</h1>
                        <h4 data-toc-skip class="author">Mauricio
Garnier-Villarreal</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ecmerkle/blavaan/blob/master/vignettes/approx_fi.Rmd" class="external-link"><code>vignettes/approx_fi.Rmd</code></a></small>
      <div class="d-none name"><code>approx_fi.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h3>
<p>In SEM, one of the first steps is to evaluate the model’s global fit.
This is commonly done by presenting multiple fit indices, with some of
the most common being based on the model’s
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>χ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\chi^2</annotation></semantics></math>.
We have developed Bayesian versions of these indices <span class="citation">(Garnier-Villarreal and Jorgensen 2020)</span> that can
be computed with <em>blavaan</em>.</p>
</div>
<div class="section level3">
<h3 id="noncentrality-based-fit-indices">Noncentrality-Based Fit Indices<a class="anchor" aria-label="anchor" href="#noncentrality-based-fit-indices"></a>
</h3>
<p>This group of indices compares the hypothesized model against the
perfect saturated model. It specifically uses the noncentrality
parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>λ</mi><mo accent="true">̂</mo></mover><mo>=</mo><msup><mi>χ</mi><mn>2</mn></msup><mo>−</mo><mi>d</mi><mi>f</mi></mrow><annotation encoding="application/x-tex">\hat{\lambda} = \chi^2 - df</annotation></semantics></math>,
with the df being adjusted by different model/data characterictics.
Specific indices include Root Mean Square Error of approximation
(RMSEA), McDonald’s centrality index (Mc), gamma-hat
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>Γ</mi><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat{\Gamma}</annotation></semantics></math>),
and adjusted gamma-hat
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>Γ</mi><mo accent="true">̂</mo></mover><mrow><mi>a</mi><mi>d</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">\hat{\Gamma}_{adj}</annotation></semantics></math>).</p>
<p>We will show an example with the <span class="citation">Holzinger and
Swineford (1939)</span> example. You first estimate your SEM/CFA model
as usual</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">HS.model</span> <span class="op">&lt;-</span> <span class="st">' visual  =~ x1 + x2 + x3</span></span>
<span><span class="st">              textual =~ x4 + x5 + x6</span></span>
<span><span class="st">              speed   =~ x7 + x8 + x9 '</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bcfa.html">bcfa</a></span><span class="op">(</span><span class="va">HS.model</span>, data<span class="op">=</span><span class="va">HolzingerSwineford1939</span>, std.lv<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>You then need to pass the model to the <code><a href="../reference/blavFitIndices.html">blavFitIndices()</a></code>
function</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gl_fits</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/blavFitIndices.html">blavFitIndices</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre></div>
<p>Finally, you can describe the posterior distribution for each of the
indices with their <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> function. With this call, we
see the 3 central tendency measures (mean median, and mode), the
standard deviation, and the 90% Credible Interval</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">gl_fits</span>, central.tendency <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean"</span>,<span class="st">"median"</span>,<span class="st">"mode"</span><span class="op">)</span>, prob <span class="op">=</span> <span class="fl">.90</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Posterior summary statistics and highest posterior density (HPD)</span></span>
<span><span class="co">##  90% credible intervals for devm-based fit indices:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##                EAP Median   MAP    SD lower upper</span></span>
<span><span class="co">## BRMSEA       0.099  0.098 0.097 0.005 0.090 0.107</span></span>
<span><span class="co">## BGammaHat    0.956  0.957 0.958 0.005 0.949 0.963</span></span>
<span><span class="co">## adjBGammaHat 0.907  0.908 0.910 0.010 0.891 0.922</span></span>
<span><span class="co">## BMc          0.902  0.904 0.906 0.010 0.886 0.918</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="incremental-fit-indices">Incremental Fit Indices<a class="anchor" aria-label="anchor" href="#incremental-fit-indices"></a>
</h3>
<p>Another group of fit indices compares the hypothesized model with the
<em>worst</em> possible model, so they are called incremental indices.
Such indices compare your model’s
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>χ</mi><mi>H</mi><mn>2</mn></msubsup><annotation encoding="application/x-tex">\chi^2_H</annotation></semantics></math>
to the <em>null</em> model’s
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>χ</mi><mn>0</mn><mn>2</mn></msubsup><annotation encoding="application/x-tex">\chi^2_0</annotation></semantics></math>
in different ways. Indices include the Comparative Fit Index (CFI),
Tucker-Lewis Index (TLI), and Normed Fit Index (NFI).</p>
<p>To estimate these indices we need to define and estimate the
respective <em>null</em> model. The standard <em>null</em> model used by
default in frequentist SEM programs (like <em>lavaan</em>) includes only
the indicators variances and intercepts, and no covariances between
items.</p>
<p>You can specify your <em>null</em> model by including only the
respective indicator variances in your model syntax, such as</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">HS.model_null</span> <span class="op">&lt;-</span> <span class="st">'</span></span>
<span><span class="st">x1 ~~ x1 </span></span>
<span><span class="st">x2 ~~ x2 </span></span>
<span><span class="st">x3 ~~ x3</span></span>
<span><span class="st">x4 ~~ x4</span></span>
<span><span class="st">x5 ~~ x5</span></span>
<span><span class="st">x6 ~~ x6</span></span>
<span><span class="st">x7 ~~ x7</span></span>
<span><span class="st">x8 ~~ x8</span></span>
<span><span class="st">x9 ~~ x9 '</span></span>
<span></span>
<span><span class="va">fit_null</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bcfa.html">bcfa</a></span><span class="op">(</span><span class="va">HS.model_null</span>, data<span class="op">=</span><span class="va">HolzingerSwineford1939</span><span class="op">)</span></span></code></pre></div>
<p>Once you have your hypothesized and null models, you pass both to the
<code>blavFitIndices</code> function, and now it will provide both types
of fit indices</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gl_fits_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/blavFitIndices.html">blavFitIndices</a></span><span class="op">(</span><span class="va">fit</span>, baseline.model <span class="op">=</span> <span class="va">fit_null</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">gl_fits_all</span>, central.tendency <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean"</span>,<span class="st">"median"</span>,<span class="st">"mode"</span><span class="op">)</span>, prob <span class="op">=</span> <span class="fl">.90</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Posterior summary statistics and highest posterior density (HPD)</span></span>
<span><span class="co">##  90% credible intervals for devm-based fit indices:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##                EAP Median   MAP    SD lower upper</span></span>
<span><span class="co">## BRMSEA       0.099  0.098 0.097 0.005 0.090 0.107</span></span>
<span><span class="co">## BGammaHat    0.956  0.957 0.958 0.005 0.949 0.963</span></span>
<span><span class="co">## adjBGammaHat 0.907  0.908 0.910 0.010 0.891 0.922</span></span>
<span><span class="co">## BMc          0.902  0.904 0.906 0.010 0.886 0.918</span></span>
<span><span class="co">## BCFI         0.930  0.931 0.933 0.008 0.917 0.942</span></span>
<span><span class="co">## BTLI         0.883  0.884 0.888 0.013 0.862 0.903</span></span>
<span><span class="co">## BNFI         0.910  0.910 0.912 0.007 0.897 0.921</span></span></code></pre>
<p>The <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> method now presents the central tendency
measure you asked for, standard deviation, and credible interval for the
noncentrality and incremental fit indices.</p>
</div>
<div class="section level3">
<h3 id="access-the-indices-posterior-distributions">Access the indices posterior distributions<a class="anchor" aria-label="anchor" href="#access-the-indices-posterior-distributions"></a>
</h3>
<p>You can also extract the posterior distributions for the respective
indices, this way you can explore further details. For example,
diagnostic plots using the <code>bayesplot</code> package.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dist_fits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">gl_fits_all</span><span class="op">@</span><span class="va">indices</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dist_fits</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##       BRMSEA BGammaHat adjBGammaHat       BMc      BCFI      BTLI      BNFI</span></span>
<span><span class="co">## 1 0.10593079 0.9499973    0.8933976 0.8883160 0.9187946 0.8644212 0.8988141</span></span>
<span><span class="co">## 2 0.10014752 0.9550694    0.9042111 0.8995598 0.9274858 0.8789319 0.9071878</span></span>
<span><span class="co">## 3 0.09712886 0.9576242    0.9096576 0.9052313 0.9319535 0.8863909 0.9115299</span></span>
<span><span class="co">## 4 0.09818988 0.9567336    0.9077589 0.9032536 0.9308408 0.8845333 0.9105678</span></span>
<span><span class="co">## 5 0.09633310 0.9582868    0.9110703 0.9067033 0.9334671 0.8889181 0.9131040</span></span>
<span><span class="co">## 6 0.09211234 0.9617252    0.9184007 0.9143465 0.9386225 0.8975255 0.9178845</span></span></code></pre>
<p>Once we have saved the posterior distributions, we can explore the
the histogram and scatterplots between indices.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/MCMC-scatterplots.html" class="external-link">mcmc_pairs</a></span><span class="op">(</span><span class="va">dist_fits</span>, pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BRMSEA"</span>,<span class="st">"BGammaHat"</span>,<span class="st">"BCFI"</span>,<span class="st">"BTLI"</span><span class="op">)</span>,</span>
<span>           diag_fun <span class="op">=</span> <span class="st">"hist"</span><span class="op">)</span></span></code></pre></div>
<p><img src="approx_fi_files/figure-html/plpi-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h3>
<p>You can estimate posterior distributions for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>χ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\chi^2</annotation></semantics></math>
based global fit indices. Notice that here we only presented the fit
indices based on the recommended method <em>devM</em> and with the
recommended number of parameters metric <em>loo</em>. These can be
adjusted by the user if desired.</p>
<p>The general recommendation is to prefer
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>Γ</mi><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat{\Gamma}</annotation></semantics></math>
and CFI, as these have shown to be less sensitive to model and data
characteristics.</p>
<p>These defaults and recommendations are made based on previous
simulation research. For more details about the fit indices please see
<span class="citation">Garnier-Villarreal and Jorgensen
(2020)</span>.</p>
</div>
<div class="section level3 unnumbered">
<h3 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-garnier_adapting_2020" class="csl-entry">
Garnier-Villarreal, Mauricio, and Terrence D Jorgensen. 2020.
<span>“Adapting <span>Fit</span> <span>Indices</span> for
<span>Bayesian</span> <span>Structural</span> <span>Equation</span>
<span>Modeling</span>: <span>Comparison</span> to <span>Maximum</span>
<span>Likelihood</span>.”</span> <em>Psychological Methods</em> 25 (1):
46–70. <a href="https://doi.org/dx.doi.org/10.1037/met0000224" class="external-link">https://doi.org/dx.doi.org/10.1037/met0000224</a>.
</div>
<div id="ref-holswi39" class="csl-entry">
Holzinger, K. J., and F. A. Swineford. 1939. <em>A Study of Factor
Analysis: <span>T</span>he Stability of a Bi-Factor Solution</em>.
Supplementary Educational Monograph 48. Chicago: University of Chicago
Press.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Edgar Merkle, Yves Rosseel, Ben Goodrich.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
