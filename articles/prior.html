<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="blavaan">
<title>Specifying Prior Distributions • blavaan</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Specifying Prior Distributions">
<meta property="og:description" content="blavaan">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">blavaan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5-5.1290</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-basics">Basics</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-basics">
    <a class="dropdown-item" href="../articles/start.html">Getting Started</a>
    <a class="dropdown-item" href="../articles/prior.html">Prior Specification</a>
    <a class="dropdown-item" href="../articles/estimate.html">Estimation</a>
    <a class="dropdown-item" href="../articles/convergence_efficiency.html">Convergence and Efficiency Evaluation</a>
    <a class="dropdown-item" href="../articles/summaries.html">Model Summaries</a>
    <a class="dropdown-item" href="../articles/plotting.html">Plots</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-examples-details">Examples/Details</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-examples-details">
    <a class="dropdown-item" href="../articles/ordinal.html">Estimation with Ordinal Data</a>
    <a class="dropdown-item" href="../articles/multilevel.html">Two-level Estimation</a>
    <a class="dropdown-item" href="../articles/invariance.html">Measurement Invariance</a>
    <a class="dropdown-item" href="../articles/approx_fi.html">Approximate Fit Indices</a>
    <a class="dropdown-item" href="../articles/model_comparison.html">Model Comparison</a>
    <a class="dropdown-item" href="../articles/cross_loadings_strong_priors.html">Cross-loadings with Strong Priors</a>
    <a class="dropdown-item" href="../articles/mod_indices.html">Modification Indices</a>
    <a class="dropdown-item" href="../articles/prior_pred_checks.html">Prior Predictive Checks</a>
    <a class="dropdown-item" href="../articles/convergence_loop.html">Convergence Loop</a>
    <a class="dropdown-item" href="../articles/probability_direction.html">Probability of Direction</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/resources.html">Resources</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ecmerkle/blavaan">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://groups.google.com/d/forum/blavaan">
    <span class="fa fa-users"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Specifying Prior Distributions</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ecmerkle/blavaan/blob/HEAD/vignettes/prior.Rmd" class="external-link"><code>vignettes/prior.Rmd</code></a></small>
      <div class="d-none name"><code>prior.Rmd</code></div>
    </div>

    
    
<p>There are two ways to specify prior distributions in blavaan. First,
each type of model parameter has a default prior distribution that may
or may not be suitable for your specific situation. You are free to
modify the defaults. Second, the priors for individual model parameters
can be specified in the model syntax. Each is discussed below.</p>
<div class="section level3">
<h3 id="defaults">Defaults<a class="anchor" aria-label="anchor" href="#defaults"></a>
</h3>
<p>The default priors can be seen via</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dpriors.html">dpriors</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                nu             alpha            lambda              beta </span></span>
<span><span class="co">##    "normal(0,32)"    "normal(0,10)"    "normal(0,10)"    "normal(0,10)" </span></span>
<span><span class="co">##             theta               psi               rho             ibpsi </span></span>
<span><span class="co">## "gamma(1,.5)[sd]" "gamma(1,.5)[sd]"       "beta(1,1)" "wishart(3,iden)" </span></span>
<span><span class="co">##               tau </span></span>
<span><span class="co">##   "normal(0,1.5)"</span></span></code></pre>
<p>It is important to note that these prior distributions correspond to
Stan parameterizations. These are similar to R parameterizations but not
necessarily exactly the same. The Greek(ish) names above correspond to
the following parameter types (where MV is manifest/observed variable
and LV is latent variable):</p>
<pre><code><span><span class="co">##                  nu               alpha              lambda                beta </span></span>
<span><span class="co">##      "MV intercept"      "LV intercept"           "Loading"        "Regression" </span></span>
<span><span class="co">##               theta                 psi                 rho               ibpsi </span></span>
<span><span class="co">##      "MV precision"      "LV precision"       "Correlation" "Covariance matrix" </span></span>
<span><span class="co">##                 tau </span></span>
<span><span class="co">##         "Threshold"</span></span></code></pre>
<p>For further information about priors on thresholds, see the <a href="ordinal.html">ordinal modeling details</a>.</p>
<p>For <code>target = "stan"</code> (the default), priors are currently
restricted to one distribution per parameter type. You can change the
prior distribution parameters (for example, the mean and standard
deviation of a normal), but you cannot change the prior distribution
type. The only exceptions here are the “theta” and “psi” parameters: for
those, you can use the modifiers “[sd]”, “[var]”, or “[prec]” to specify
whether you want the priors to apply to the standard deviation,
variance, or precision. If you require more flexibility in prior
specification, you change the target to either
<code>"stanclassic"</code> (the old Stan approach) or
<code>"jags"</code> (the JAGS approach). Alternatively, you can export
the Stan model via <code>mcmcfile = TRUE</code>, edit the file as
needed, then fit it via the rstan package.</p>
<p>To modify prior distributions, we could simply supply a new text
string to <code><a href="../reference/dpriors.html">dpriors()</a></code> like this:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mydp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpriors.html">dpriors</a></span><span class="op">(</span>lambda<span class="op">=</span><span class="st">"normal(1,2)"</span><span class="op">)</span></span>
<span><span class="va">mydp</span></span></code></pre></div>
<pre><code><span><span class="co">##                nu             alpha            lambda              beta </span></span>
<span><span class="co">##    "normal(0,32)"    "normal(0,10)"     "normal(1,2)"    "normal(0,10)" </span></span>
<span><span class="co">##             theta               psi               rho             ibpsi </span></span>
<span><span class="co">## "gamma(1,.5)[sd]" "gamma(1,.5)[sd]"       "beta(1,1)" "wishart(3,iden)" </span></span>
<span><span class="co">##               tau </span></span>
<span><span class="co">##   "normal(0,1.5)"</span></span></code></pre>
<p>so that the default prior for loadings is now normal with mean 1 and
standard deviation 2, and the rest of the parameters remain at the
original defaults. The next time we estimate a model (via
<code><a href="../reference/bsem.html">bsem()</a></code>, <code><a href="../reference/bcfa.html">bcfa()</a></code>, <code><a href="../reference/bgrowth.html">bgrowth()</a></code>, or
<code><a href="../reference/blavaan.html">blavaan()</a></code>), we would add the argument <code>dp=mydp</code>
to use this new set of default priors.</p>
</div>
<div class="section level3">
<h3 id="individual-parameters">Individual Parameters<a class="anchor" aria-label="anchor" href="#individual-parameters"></a>
</h3>
<p>In addition to setting the prior for one type of model parameter, the
user may wish to set the prior of a specific model parameter. This is
accomplished by using the <code>prior()</code> modifier within the model
specification. For example, consider the following syntax for the <span class="citation">Holzinger and Swineford (1939)</span> confirmatory
factor model:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">HS.model</span> <span class="op">&lt;-</span> <span class="st">' visual  =~ x1 + prior("normal(1,2)")*x2 + x3</span></span>
<span><span class="st">              textual =~ x4 + x5 + prior("normal(3,1.5)")*x6</span></span>
<span><span class="st">              speed   =~ x7 + x8 + x9 </span></span>
<span><span class="st">              x1 ~~ prior("gamma(3,3)[sd]")*x1 '</span></span></code></pre></div>
<p>The loading from <code>visual</code> to <code>x2</code> now has a
normal prior with mean 1 and standard deviation 2, while the loading
from <code>textual</code> to <code>x6</code> has a normal prior with
mean 3 and standard deviation 1.5. All other loadings have the default
prior distribution.</p>
<p>In the above syntax, we have additionally specified a gamma(3,3)
prior associated with the residual of <code>x1</code>. The
<code>[sd]</code> text at the end of the distribution says that this
prior goes on the residual standard deviation, as opposed to the
residual precision or residual variance. There exist two more options
here: a <code>[var]</code> option for the residual variance, and no
brackets for the precision (or you could also use <code>[prec]</code>).
This bracketed text can be used for any model variance/SD/precision
parameter and could also be used in default prior specification if
desired.</p>
</div>
<div class="section level3">
<h3 id="covariance-parameters">Covariance Parameters<a class="anchor" aria-label="anchor" href="#covariance-parameters"></a>
</h3>
<p>One additional note on covariance parameters defined in the model
syntax: the <code>prior()</code> syntax specifies a prior on the
correlation associated with the covariance parameter, as opposed to the
covariance itself. The specified distribution should have support on
(0,1), and blavaan automatically translates the prior to an equivalent
distribution with support on (-1,1). It is safest to stick with beta
priors here. For example, the syntax</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">HS.model</span> <span class="op">&lt;-</span> <span class="st">' visual  =~ x1 + x2 + x3</span></span>
<span><span class="st">              textual =~ x4 + x5 + x6</span></span>
<span><span class="st">              speed   =~ x7 + x8 + x9 </span></span>
<span><span class="st">              visual ~~ prior("beta(1,1)")*textual '</span></span></code></pre></div>
<p>places a Beta(1,1) (uniform) prior on the correlation between the
<code>visual</code> and <code>textual</code> factors. If desired, we
could also specify priors on the standard deviations (or variances or
precisions) of the <code>visual</code> and <code>textual</code> factors.
Together with the prior on the correlation, these priors would imply a
prior on the covariance between <code>visual</code> and
<code>textual</code>.</p>
</div>
<div class="section level3 unnumbered">
<h3 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-holswi39" class="csl-entry">
Holzinger, K. J., and F. A. Swineford. 1939. <em>A Study of Factor
Analysis: <span>T</span>he Stability of a Bi-Factor Solution</em>.
Supplementary Educational Monograph 48. Chicago: University of Chicago
Press.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Edgar Merkle, Yves Rosseel, Ben Goodrich.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
