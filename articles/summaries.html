<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="blavaan">
<title>Model Summaries • blavaan</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Model Summaries">
<meta property="og:description" content="blavaan">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">blavaan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5-3.1253</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-basics">Basics</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-basics">
    <a class="dropdown-item" href="../articles/start.html">Getting Started</a>
    <a class="dropdown-item" href="../articles/prior.html">Prior Specification</a>
    <a class="dropdown-item" href="../articles/estimate.html">Estimation</a>
    <a class="dropdown-item" href="../articles/convergence_efficiency.html">Convergence and Efficiency Evaluation</a>
    <a class="dropdown-item" href="../articles/summaries.html">Model Summaries</a>
    <a class="dropdown-item" href="../articles/plotting.html">Plots</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-examples-details">Examples/Details</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-examples-details">
    <a class="dropdown-item" href="../articles/ordinal.html">Estimation with Ordinal Data</a>
    <a class="dropdown-item" href="../articles/multilevel.html">Two-level Estimation</a>
    <a class="dropdown-item" href="../articles/invariance.html">Measurement Invariance</a>
    <a class="dropdown-item" href="../articles/approx_fi.html">Approximate Fit Indices</a>
    <a class="dropdown-item" href="../articles/model_comparison.html">Model Comparison</a>
    <a class="dropdown-item" href="../articles/cross_loadings_strong_priors.html">Cross-loadings with Strong Priors</a>
    <a class="dropdown-item" href="../articles/mod_indices.html">Modification Indices</a>
    <a class="dropdown-item" href="../articles/prior_pred_checks.html">Prior Predictive Checks</a>
    <a class="dropdown-item" href="../articles/convergence_loop.html">Convergence Loop</a>
    <a class="dropdown-item" href="../articles/probability_direction.html">Probability of Direction</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/resources.html">Resources</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ecmerkle/blavaan">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://groups.google.com/d/forum/blavaan">
    <span class="fa fa-users"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Model Summaries</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ecmerkle/blavaan/blob/HEAD/vignettes/summaries.Rmd" class="external-link"><code>vignettes/summaries.Rmd</code></a></small>
      <div class="d-none name"><code>summaries.Rmd</code></div>
    </div>

    
    
<p>Say that we specify a model of the Bollen political democracy data
and draw posterior samples using the following <em>blavaan</em> code
(where <code>save.lvs</code> saves the latent variable samples for
further use):</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">model</span> <span class="op">&lt;-</span> <span class="st">' </span></span>
<span><span class="st">    # latent variable definitions</span></span>
<span><span class="st">    ind60 =~ x1 + x2 + x3</span></span>
<span><span class="st">    dem60 =~ y1 + a*y2 + b*y3 + c*y4</span></span>
<span><span class="st">    dem65 =~ y5 + a*y6 + b*y7 + c*y8</span></span>
<span><span class="st">     </span></span>
<span><span class="st">    # regressions</span></span>
<span><span class="st">    dem60 ~ ind60</span></span>
<span><span class="st">    dem65 ~ ind60 + dem60</span></span>
<span><span class="st">     </span></span>
<span><span class="st">    # residual correlations</span></span>
<span><span class="st">    y1 ~~ y5</span></span>
<span><span class="st">    y2 ~~ y4 + y6</span></span>
<span><span class="st">    y3 ~~ y7</span></span>
<span><span class="st">    y4 ~~ y8</span></span>
<span><span class="st">    y6 ~~ y8</span></span>
<span><span class="st">  '</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bsem.html">bsem</a></span><span class="op">(</span><span class="va">model</span>, data<span class="op">=</span><span class="va">PoliticalDemocracy</span>, save.lvs <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>We describe here how to summarize the fitted model. The most obvious
functions are <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>, <code><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef()</a></code>, and
<code><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov()</a></code>, which all work in a manner similar to the analogous
<em>lavaan</em> functions. But instead of maximum likelihood estimates
and standard errors, <em>blavaan</em> reports posterior means and
posterior standard deviations. Other summaries that are unique to
Bayesian models include model convergence metrics, model fit/comparison
metrics, and samples of latent variables. These are discussed below.</p>
<div class="section level3">
<h3 id="convergence">Convergence<a class="anchor" aria-label="anchor" href="#convergence"></a>
</h3>
<p>Following model estimation, we immediately wish to look at the
“goodness” of the posterior samples, including convergence to a
stationary distribution and autocorrelation. Popular convergence metrics
are available via the <code><a href="../reference/blavInspect.html">blavInspect()</a></code> function:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/blavInspect.html">blavInspect</a></span><span class="op">(</span><span class="va">fit</span>, <span class="st">'rhat'</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/blavInspect.html">blavInspect</a></span><span class="op">(</span><span class="va">fit</span>, <span class="st">'neff'</span><span class="op">)</span></span></code></pre></div>
<p>where R-hat values near 1.00 indicate convergence, and large
effective sample sizes (hundreds or above) are preferred. For details on
these metrics, see, e.g., the Posterior Analysis section of the <a href="https://mc-stan.org/docs/2_28/reference-manual/index.html" class="external-link">Stan
Reference Manual</a>.</p>
<p>If the model has definitely not converged (as judged by Rhat),
blavaan will issue multiple warnings. Lack of convergence is sometimes
caused by bad initial values or by a chain that strays to an extreme
region of the posterior space. In these cases, it can be helpful to
re-estimate the model a second time. It is also helpful to specify
mildly-informative priors on loading parameters, so that the chains do
not wander to extreme loading values. For example, if you expect all
your variables to be positively correlated and some loadings are being
fixed to 1 for identification, then Normal(1,.5) would often be a
mildly-informative prior. Otherwise, lack of convergence may imply prior
distributions that severely conflict with the data, or an ill-defined
model. It is sometimes helpful to try to fit the same model in
<em>lavaan</em>, to observe whether errors occur there.</p>
</div>
<div class="section level3">
<h3 id="model-fit-comparison">Model Fit &amp; Comparison<a class="anchor" aria-label="anchor" href="#model-fit-comparison"></a>
</h3>
<p>Next, we may wish to examine some model fit metrics. While many
metrics are available from the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> output, more are
available from the <code><a href="https://rdrr.io/pkg/lavaan/man/fitMeasures.html" class="external-link">fitMeasures()</a></code> function:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/fitMeasures.html" class="external-link">fitMeasures</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre></div>
<p>For judging absolute fit, <em>blavaan</em> supplies a posterior
predictive p-value that is based on the likelihood ratio statistic.
Good-fitting models have values near 0.5 on this metric. For examining
models’ relative fits, <em>blavaan</em> supplies the DIC, WAIC, and
LOOIC. The latter two metrics are computed with the help of the
<em>loo</em> package <span class="citation">(Vehtari et al.
2020)</span>. Comparison of multiple models on these criteria is
facilitated via <code><a href="../reference/blavCompare.html">blavCompare()</a></code>, which provides standard
errors of the difference between two criteria.</p>
<p>Other notable functions include <code><a href="../reference/blavFitIndices.html">blavFitIndices()</a></code> for
alternative measures of absolute fit and <code><a href="../reference/ppmc.html">ppmc()</a></code> for general
posterior predictive checks.</p>
</div>
<div class="section level3">
<h3 id="latent-variables-standardization">Latent Variables &amp; Standardization<a class="anchor" aria-label="anchor" href="#latent-variables-standardization"></a>
</h3>
<p>An often-discussed advantage of Bayesian models is their abilities to
describe uncertainty in “random” parameters, including random effects
and latent variables. To access this functionality in <em>blavaan</em>,
users must set <code>save.lvs = TRUE</code> during model estimation, as
is done at the top of this page. After model estimation, uses can access
this information via <code><a href="../reference/blavInspect.html">blavInspect()</a></code> or
<code><a href="../reference/blavPredict.html">blavPredict()</a></code>. Relevant arguments to
<code><a href="../reference/blavInspect.html">blavInspect()</a></code> include <code>lvmeans</code> and
<code>lvs</code>. The former returns posterior means of latent
variables, which are similar to the predictions supplied by frequentist
models. The latter returns posterior samples of latent variables, so
that users could summarize their uncertainties or other functions of
latent variables. These posterior samples are returned as a list of
length <code>n.chains</code>, where each list entry has a row per
posterior sample (and number of columns is total number of latent
variables in the model):</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">postmns</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/blavInspect.html">blavInspect</a></span><span class="op">(</span><span class="va">fit</span>, what <span class="op">=</span> <span class="st">"lvmeans"</span><span class="op">)</span></span>
<span><span class="va">postsamps</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/blavInspect.html">blavInspect</a></span><span class="op">(</span><span class="va">fit</span>, what <span class="op">=</span> <span class="st">"lvs"</span><span class="op">)</span></span></code></pre></div>
<p>Some related, but different, information can be obtained by
<code><a href="../reference/blavPredict.html">blavPredict()</a></code>. This function will also return posterior
samples of latent variables, but in a matrix instead of a list:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">postsamps</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/blavPredict.html">blavPredict</a></span><span class="op">(</span><span class="va">fit</span>, type <span class="op">=</span> <span class="st">"lv"</span><span class="op">)</span></span></code></pre></div>
<p>The <code><a href="../reference/blavPredict.html">blavPredict()</a></code> function will also return predictions
of observed variables conditioned on the sampled latent variables. The
<code>type = "yhat"</code> argument returns expected values of observed
variables conditioned on latent variable samples; the
<code>type = "ypred"</code> argument returns posterior predictions of
observed variables including residual noise (essentially
<code>yhat</code> + error); and the <code>type = "ymis"</code> argument
returns posterior predictions of missing variables conditioned on
observed. These expected values and predictions are returned in list
format; for a matrix, see the last line of code below.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">evpreds</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/blavPredict.html">blavPredict</a></span><span class="op">(</span><span class="va">fit</span>, type <span class="op">=</span> <span class="st">"yhat"</span><span class="op">)</span></span>
<span><span class="va">postpreds</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/blavPredict.html">blavPredict</a></span><span class="op">(</span><span class="va">fit</span>, type <span class="op">=</span> <span class="st">"ypred"</span><span class="op">)</span></span>
<span><span class="va">mispreds</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/blavPredict.html">blavPredict</a></span><span class="op">(</span><span class="va">fit</span>, type <span class="op">=</span> <span class="st">"ymis"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## convert to matrix from list:</span></span>
<span><span class="va">evpreds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="st">"rbind"</span>, <span class="va">evpreds</span><span class="op">)</span></span></code></pre></div>
<p>Finally, not fully related to latent variables: the
<code><a href="../reference/standardizedPosterior.html">standardizedPosterior()</a></code> function will return standardized
posterior draws. It calls the <em>lavaan</em> function
<code><a href="https://rdrr.io/pkg/lavaan/man/standardizedSolution.html" class="external-link">standardizedSolution()</a></code> in the background and has some of
that function’s flexibility.</p>
</div>
<div class="section level3 unnumbered">
<h3 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-loo" class="csl-entry">
Vehtari, Aki, Jonah Gabry, Mans Magnusson, Yuling Yao, Paul-Christian
Bürkner, Topi Paananen, and Andrew Gelman. 2020. <span>“Loo: Efficient
Leave-One-Out Cross-Validation and WAIC for Bayesian Models.”</span> <a href="https://mc-stan.org/loo/" class="external-link">https://mc-stan.org/loo/</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Edgar Merkle, Yves Rosseel, Ben Goodrich.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
